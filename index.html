<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrbanPluse AI - By Dream Debuggers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: #0f0f23;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .neon-blue { color: #00d4ff; }
        .neon-green { color: #00ff88; }
        .neon-purple { color: #8b5cf6; }
        .neon-orange { color: #ff6b35; }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .traffic-light {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 2px;
            transition: all 0.3s ease;
        }
        
        .red-light { background: #ef4444; box-shadow: 0 0 10px #ef4444; }
        .yellow-light { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }
        .green-light { background: #10b981; box-shadow: 0 0 10px #10b981; }
        .off-light { background: #374151; }
        
        .detection-box {
            position: absolute;
            border: 2px solid;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            padding: 2px 4px;
            animation: detectPulse 1s ease-in-out infinite;
        }
        
        @keyframes detectPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .vehicle-box { border-color: #00d4ff; color: #00d4ff; background: rgba(0, 212, 255, 0.1); }
        .person-box { border-color: #ff6b35; color: #ff6b35; background: rgba(255, 107, 53, 0.1); }
        
        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        .metric-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .traffic-flow-animation {
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(0, 255, 136, 0.3) 25%, 
                rgba(255, 107, 53, 0.3) 50%, 
                rgba(239, 68, 68, 0.3) 75%, 
                transparent 100%);
            animation: flowMove 3s ease-in-out infinite;
        }
        
        @keyframes flowMove {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }
        
        .intersection-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .intersection-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 212, 255, 0.3);
            transform: translateY(-4px);
        }
        
        .alert-critical {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.1));
            border-left: 4px solid #ef4444;
            animation: alertPulse 2s infinite;
        }
        
        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.6); }
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #0ea5e9);
            border: none;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.5);
        }
    </style>
</head>
<body class="text-white min-h-screen gradient-bg">
    <!-- Header -->
    <header class="glass-card border-b border-gray-700 px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                    <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-white">TrafficFlow AI</h1>
                    <p class="text-gray-400 text-sm">Smart Traffic Management System v5.0</p>
                </div>
            </div>
            <div class="flex items-center space-x-6">
                <div class="text-right">
                    <div class="text-sm text-gray-400">System Status</div>
                    <div class="flex items-center space-x-2">
                        <div class="status-indicator bg-green-400"></div>
                        <span class="text-green-400 font-medium">Online</span>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">AI Accuracy</div>
                    <div id="aiAccuracy" class="font-medium neon-blue">97.3%</div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Last Update</div>
                    <div id="lastUpdate" class="font-medium text-gray-300">--:--:--</div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-80 glass-card border-r border-gray-700 p-6 overflow-y-auto">
            <div class="space-y-6">
                <!-- AI Control Panel -->
                <div class="metric-card rounded-xl p-5">
                    <h3 class="font-semibold mb-4 flex items-center neon-blue">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"/>
                        </svg>
                        AI Control Center
                    </h3>
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="glass-card rounded-lg p-3 text-center">
                            <div class="text-2xl font-bold neon-green" id="activeIntersections">24</div>
                            <div class="text-xs text-gray-400">Active Intersections</div>
                        </div>
                        <div class="glass-card rounded-lg p-3 text-center">
                            <div class="text-2xl font-bold neon-purple" id="vehiclesTracked">1,247</div>
                            <div class="text-xs text-gray-400">Vehicles Tracked</div>
                        </div>
                        <div class="glass-card rounded-lg p-3 text-center">
                            <div class="text-2xl font-bold neon-orange" id="avgWaitTime">2.3m</div>
                            <div class="text-xs text-gray-400">Avg Wait Time</div>
                        </div>
                        <div class="glass-card rounded-lg p-3 text-center">
                            <div class="text-2xl font-bold neon-blue" id="efficiency">94%</div>
                            <div class="text-xs text-gray-400">Efficiency</div>
                        </div>
                    </div>
                </div>

                <!-- Traffic Predictions -->
                <div class="metric-card rounded-xl p-5">
                    <h3 class="font-semibold mb-4 flex items-center neon-purple">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 102 0V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm2.5 7a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm2.45 4a2.5 2.5 0 10-4.9 0h4.9zM12 9a1 1 0 100 2h3a1 1 0 100-2h-3zm-1 4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z" clip-rule="evenodd"/>
                        </svg>
                        Traffic Predictions
                    </h3>
                    <div class="space-y-3">
                        <div class="glass-card rounded p-3">
                            <div class="text-sm font-medium neon-blue">Next 15 Minutes</div>
                            <div class="text-xs text-gray-300 mt-1" id="prediction15">Moderate increase expected at Junction A</div>
                        </div>
                        <div class="glass-card rounded p-3">
                            <div class="text-sm font-medium neon-green">Next Hour</div>
                            <div class="text-xs text-gray-300 mt-1" id="prediction60">Traffic will normalize by 3:30 PM</div>
                        </div>
                        <div class="glass-card rounded p-3">
                            <div class="text-sm font-medium neon-orange">Confidence</div>
                            <div class="text-lg font-bold neon-orange" id="predictionConfidence">89.2%</div>
                        </div>
                    </div>
                </div>

                <!-- Incident Alerts -->
                <div class="metric-card rounded-xl p-5">
                    <h3 class="font-semibold mb-4 flex items-center text-red-400">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5v3a.75.75 0 001.5 0v-3A.75.75 0 009 9z" clip-rule="evenodd"/>
                        </svg>
                        Active Incidents
                    </h3>
                    <div class="space-y-2" id="incidentList">
                        <div class="text-sm text-gray-400 text-center py-2">No active incidents</div>
                    </div>
                    <div class="mt-4 space-y-2">
                        <button class="w-full btn-secondary text-white py-2 px-3 rounded-lg text-sm" onclick="simulateIncident('accident')">
                            üöó Simulate Accident
                        </button>
                        <button class="w-full btn-secondary text-white py-2 px-3 rounded-lg text-sm" onclick="simulateIncident('construction')">
                            üöß Road Work
                        </button>
                        <button class="w-full btn-secondary text-white py-2 px-3 rounded-lg text-sm" onclick="simulateIncident('weather')">
                            üåßÔ∏è Weather Alert
                        </button>
                    </div>
                </div>

                <!-- System Controls -->
                <div class="metric-card rounded-xl p-5">
                    <h3 class="font-semibold mb-4 flex items-center text-yellow-400">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                        </svg>
                        System Controls
                    </h3>
                    <div class="space-y-3">
                        <button class="w-full btn-primary text-white py-2 px-4 rounded-lg font-medium" onclick="optimizeTraffic()">
                            ‚ö° Optimize Traffic
                        </button>
                        <button class="w-full btn-secondary text-white py-2 px-4 rounded-lg" onclick="emergencyMode()">
                            üö® Emergency Mode
                        </button>
                        <button class="w-full btn-secondary text-white py-2 px-4 rounded-lg" onclick="resetSystem()">
                            üîÑ Reset System
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 overflow-y-auto">
            <div class="space-y-6">
                <!-- CCTV Feeds -->
                <div class="glass-card rounded-xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-white flex items-center">
                            <svg class="w-7 h-7 mr-3 neon-blue" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M2 6a2 2 0 012-2h6l2 2h6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"/>
                            </svg>
                            Live CCTV Feeds
                        </h2>
                        <div class="flex space-x-3">
                            <button onclick="uploadVideo()" class="btn-secondary px-4 py-2 rounded-lg text-sm font-medium hover-glow">
                                üìπ Upload Video
                            </button>
                            <button onclick="toggleDetection()" class="btn-primary px-4 py-2 rounded-lg text-sm font-medium">
                                ü§ñ AI Detection: ON
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <!-- Feed 1 -->
                        <div class="glass-card rounded-lg overflow-hidden hover-glow" id="feed1">
                            <div class="aspect-video bg-gray-900 relative">
                                <div class="absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">
                                    üî¥ LIVE
                                </div>
                                <div class="absolute top-2 right-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    JKLU Main Gate
                                </div>
                                <canvas id="canvas1" class="w-full h-full"></canvas>
                                <div class="absolute inset-0 pointer-events-none" id="overlay1"></div>
                                <div class="absolute bottom-2 left-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    Objects: <span id="count1" class="neon-blue">0</span> | FPS: <span id="fps1" class="neon-green">30</span>
                                </div>
                            </div>
                        </div>

                        <!-- Feed 2 -->
                        <div class="glass-card rounded-lg overflow-hidden hover-glow" id="feed2">
                            <div class="aspect-video bg-gray-900 relative">
                                <div class="absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">
                                    üî¥ LIVE
                                </div>
                                <div class="absolute top-2 right-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    Mahapura Junction
                                </div>
                                <canvas id="canvas2" class="w-full h-full"></canvas>
                                <div class="absolute inset-0 pointer-events-none" id="overlay2"></div>
                                <div class="absolute bottom-2 left-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    Objects: <span id="count2" class="neon-blue">0</span> | FPS: <span id="fps2" class="neon-green">30</span>
                                </div>
                            </div>
                        </div>

                        <!-- Feed 3 -->
                        <div class="glass-card rounded-lg overflow-hidden hover-glow" id="feed3">
                            <div class="aspect-video bg-gray-900 relative">
                                <div class="absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">
                                    üî¥ LIVE
                                </div>
                                <div class="absolute top-2 right-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    Bagru Highway
                                </div>
                                <canvas id="canvas3" class="w-full h-full"></canvas>
                                <div class="absolute inset-0 pointer-events-none" id="overlay3"></div>
                                <div class="absolute bottom-2 left-2 glass-card text-white px-2 py-1 rounded text-xs">
                                    Objects: <span id="count3" class="neon-blue">0</span> | FPS: <span id="fps3" class="neon-green">30</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Detection Legend -->
                    <div class="glass-card rounded-lg p-4">
                        <h4 class="font-medium mb-3 neon-blue">AI Detection Legend</h4>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 border-2 border-blue-400 bg-blue-400 bg-opacity-20 rounded"></div>
                                <span class="text-sm">Vehicles</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 border-2 border-orange-400 bg-orange-400 bg-opacity-20 rounded"></div>
                                <span class="text-sm">Pedestrians</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 border-2 border-green-400 bg-green-400 bg-opacity-20 rounded"></div>
                                <span class="text-sm">Predicted Path</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Traffic Grid -->
                <div class="glass-card rounded-xl p-6">
                    <h2 class="text-2xl font-bold mb-6 text-white flex items-center">
                        <svg class="w-7 h-7 mr-3 neon-green" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                        </svg>
                        Traffic Control Grid - Jaipur
                    </h2>
                    
                    <div class="grid grid-cols-3 gap-6 max-w-4xl mx-auto mb-6" id="trafficGrid">
                        <!-- Traffic intersections will be generated here -->
                    </div>
                </div>

                <!-- Analytics -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 neon-blue">Traffic Flow Analysis</h3>
                        <canvas id="flowChart" width="400" height="200"></canvas>
                    </div>
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 neon-purple">AI Performance Metrics</h3>
                        <canvas id="performanceChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- Event Log -->
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-lg font-semibold mb-4 text-white flex items-center">
                        <svg class="w-6 h-6 mr-2 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                        System Event Log
                    </h3>
                    <div class="space-y-3" id="eventLog">
                        <!-- Events will be populated here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // System variables
        let aiDetectionEnabled = true;
        let canvases = {};
        let activeIncidents = [];

        // Initialize canvases
        function initializeCanvases() {
            for (let i = 1; i <= 3; i++) {
                const canvas = document.getElementById(`canvas${i}`);
                const ctx = canvas.getContext('2d');
                canvases[i] = ctx;
                
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
                
                startVideoFeed(i);
            }
        }

        // Simulate video feed
        function startVideoFeed(feedId) {
            const canvas = document.getElementById(`canvas${feedId}`);
            const ctx = canvases[feedId];
            let frame = 0;
            
            function animate() {
                // Clear canvas
                ctx.fillStyle = '#1f2937';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw road
                ctx.fillStyle = '#374151';
                ctx.fillRect(0, canvas.height * 0.4, canvas.width, canvas.height * 0.2);
                
                // Draw lane markings
                ctx.fillStyle = '#ffffff';
                for (let x = 0; x < canvas.width; x += 40) {
                    ctx.fillRect(x + (frame % 40), canvas.height * 0.48, 20, 4);
                }
                
                // Draw moving objects
                drawMovingObjects(ctx, canvas, frame, feedId);
                
                frame++;
                requestAnimationFrame(animate);
            }
            
            animate();
        }

        // Draw moving objects
        function drawMovingObjects(ctx, canvas, frame, feedId) {
            const objects = [
                { 
                    type: 'vehicle', 
                    x: (frame * 2) % (canvas.width + 60) - 30, 
                    y: canvas.height * 0.42, 
                    w: 40, h: 16,
                    confidence: 0.95
                },
                { 
                    type: 'person', 
                    x: canvas.width - ((frame * 1.5) % (canvas.width + 20)), 
                    y: canvas.height * 0.65, 
                    w: 12, h: 20,
                    confidence: 0.88
                }
            ];
            
            let detectedCount = 0;
            
            objects.forEach((obj, index) => {
                if (obj.x > -obj.w && obj.x < canvas.width) {
                    // Draw object
                    ctx.fillStyle = obj.type === 'vehicle' ? '#3b82f6' : '#f59e0b';
                    ctx.fillRect(obj.x, obj.y, obj.w, obj.h);
                    
                    detectedCount++;
                    
                    // Create detection box
                    if (aiDetectionEnabled && Math.random() < 0.3) {
                        createDetectionBox(feedId, obj, index);
                    }
                }
            });
            
            // Update counters
            document.getElementById(`count${feedId}`).textContent = detectedCount;
        }

        // Create detection box
        function createDetectionBox(feedId, obj, index) {
            const overlay = document.getElementById(`overlay${feedId}`);
            const detectionId = `detection_${feedId}_${index}`;
            
            // Remove existing detection
            const existing = document.getElementById(detectionId);
            if (existing) existing.remove();
            
            const detection = document.createElement('div');
            detection.id = detectionId;
            detection.className = `detection-box ${obj.type}-box`;
            detection.style.left = `${obj.x}px`;
            detection.style.top = `${obj.y}px`;
            detection.style.width = `${obj.w}px`;
            detection.style.height = `${obj.h}px`;
            detection.innerHTML = `
                <div>${obj.type.toUpperCase()}</div>
                <div>${obj.confidence.toFixed(2)}</div>
            `;
            
            overlay.appendChild(detection);
            
            // Remove after 2 seconds
            setTimeout(() => {
                if (detection.parentNode) {
                    detection.parentNode.removeChild(detection);
                }
            }, 2000);
        }

        // Generate traffic grid
        function generateTrafficGrid() {
            const grid = document.getElementById('trafficGrid');
            const intersections = [
                { name: 'JKLU Main Gate', id: 'A1', status: 'optimal' },
                { name: 'Mahapura Junction', id: 'A2', status: 'congested' },
                { name: 'Ajmer Road', id: 'A3', status: 'moderate' },
                { name: 'Bagru Highway', id: 'B1', status: 'optimal' },
                { name: 'Sitapura Circle', id: 'B2', status: 'moderate' },
                { name: 'Tonk Road', id: 'B3', status: 'optimal' },
                { name: 'Sanganer', id: 'C1', status: 'moderate' },
                { name: 'Mansarovar', id: 'C2', status: 'congested' },
                { name: 'Vaishali Nagar', id: 'C3', status: 'optimal' }
            ];
            
            intersections.forEach(intersection => {
                const card = document.createElement('div');
                card.className = 'intersection-card rounded-lg p-4';
                card.dataset.intersection = intersection.id;
                
                const statusColors = {
                    optimal: 'neon-green',
                    moderate: 'text-yellow-400',
                    congested: 'neon-orange'
                };
                
                card.innerHTML = `
                    <div class="text-center mb-3">
                        <div class="text-sm font-semibold text-white">${intersection.name}</div>
                        <div class="text-xs text-gray-400">ID: ${intersection.id}</div>
                    </div>
                    <div class="flex justify-center mb-3">
                        <div class="flex flex-col space-y-1">
                            <div class="traffic-light ${getTrafficLightState(intersection.status, 'red')}"></div>
                            <div class="traffic-light ${getTrafficLightState(intersection.status, 'yellow')}"></div>
                            <div class="traffic-light ${getTrafficLightState(intersection.status, 'green')}"></div>
                        </div>
                    </div>
                    <div class="traffic-flow-animation h-2 rounded mb-3"></div>
                    <div class="text-xs text-center ${statusColors[intersection.status]} font-semibold">
                        ${intersection.status.toUpperCase()}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Get traffic light state
        function getTrafficLightState(status, color) {
            const states = {
                optimal: { red: 'off-light', yellow: 'off-light', green: 'green-light' },
                moderate: { red: 'off-light', yellow: 'yellow-light', green: 'off-light' },
                congested: { red: 'red-light', yellow: 'off-light', green: 'off-light' }
            };
            
            return states[status][color];
        }

        // Simulate incident
        function simulateIncident(type) {
            const incidents = {
                accident: {
                    icon: 'üöó',
                    title: 'Vehicle Accident',
                    description: 'Multi-vehicle collision at Mahapura Junction',
                    severity: 'critical'
                },
                construction: {
                    icon: 'üöß',
                    title: 'Road Construction',
                    description: 'Lane closure on Ajmer Road for maintenance',
                    severity: 'warning'
                },
                weather: {
                    icon: 'üåßÔ∏è',
                    title: 'Weather Alert',
                    description: 'Heavy rainfall affecting visibility',
                    severity: 'info'
                }
            };
            
            const incident = incidents[type];
            incident.id = Date.now();
            incident.timestamp = new Date();
            
            showIncident(incident);
            addEvent(`üö® ${incident.title}: ${incident.description}`);
            
            // Auto-resolve after 10 seconds
            setTimeout(() => {
                resolveIncident(incident.id);
            }, 10000);
        }

        // Show incident
        function showIncident(incident) {
            const container = document.getElementById('incidentList');
            
            // Remove "no incidents" message
            const noIncidents = container.querySelector('.text-gray-400');
            if (noIncidents) noIncidents.remove();
            
            const alertDiv = document.createElement('div');
            alertDiv.id = `incident-${incident.id}`;
            alertDiv.className = `alert-${incident.severity} glass-card p-3 rounded-lg`;
            
            alertDiv.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex items-start space-x-2">
                        <span class="text-lg">${incident.icon}</span>
                        <div>
                            <div class="font-semibold text-sm text-white">${incident.title}</div>
                            <div class="text-xs text-gray-300">${incident.description}</div>
                            <div class="text-xs text-gray-400 mt-1">${incident.timestamp.toLocaleTimeString()}</div>
                        </div>
                    </div>
                    <button onclick="resolveIncident(${incident.id})" class="text-gray-400 hover:text-white text-xs">
                        ‚úï
                    </button>
                </div>
            `;
            
            container.appendChild(alertDiv);
        }

        // Resolve incident
        function resolveIncident(incidentId) {
            const alertElement = document.getElementById(`incident-${incidentId}`);
            if (alertElement) {
                alertElement.remove();
            }
            
            const container = document.getElementById('incidentList');
            if (container.children.length === 0) {
                container.innerHTML = '<div class="text-sm text-gray-400 text-center py-2">No active incidents</div>';
            }
            
            addEvent(`‚úÖ Incident resolved - Traffic flow restored`);
        }

        // Add event to log
        function addEvent(customEvent = null) {
            const events = [
                "ü§ñ AI optimization reduced wait times by 15%",
                "üìä Traffic pattern analysis completed",
                "üö¶ Signal timing adjusted for peak hours",
                "üì± Mobile app notifications sent to 1,247 users",
                "üîÑ System backup completed successfully",
                "üìà Efficiency improved to 94.2%",
                "üöó 1,247 vehicles processed in last hour",
                "‚ö° Emergency vehicle priority activated"
            ];
            
            const eventLog = document.getElementById('eventLog');
            const newEvent = document.createElement('div');
            newEvent.className = 'flex items-center justify-between p-3 glass-card rounded-lg hover-glow';
            newEvent.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="status-indicator bg-blue-400"></div>
                    <span class="text-sm">${customEvent || events[Math.floor(Math.random() * events.length)]}</span>
                </div>
                <span class="text-gray-400 text-xs">Just now</span>
            `;
            
            eventLog.insertBefore(newEvent, eventLog.firstChild);
            
            // Keep only last 5 events
            while (eventLog.children.length > 5) {
                eventLog.removeChild(eventLog.lastChild);
            }
        }

        // Update metrics
        function updateMetrics() {
            document.getElementById('aiAccuracy').textContent = (95 + Math.random() * 5).toFixed(1) + '%';
            document.getElementById('activeIntersections').textContent = Math.floor(20 + Math.random() * 10);
            document.getElementById('vehiclesTracked').textContent = (1200 + Math.floor(Math.random() * 100)).toLocaleString();
            document.getElementById('avgWaitTime').textContent = (2 + Math.random() * 2).toFixed(1) + 'm';
            document.getElementById('efficiency').textContent = Math.floor(90 + Math.random() * 10) + '%';
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            
            // Update predictions
            const predictions = [
                "Moderate increase expected at Junction A",
                "Heavy traffic predicted on Ajmer Road",
                "Optimal flow conditions forecasted",
                "Weather may impact visibility",
                "Rush hour congestion building"
            ];
            
            document.getElementById('prediction15').textContent = predictions[Math.floor(Math.random() * predictions.length)];
            document.getElementById('predictionConfidence').textContent = (85 + Math.random() * 15).toFixed(1) + '%';
        }

        // Initialize charts
        function initializeCharts() {
            const flowCtx = document.getElementById('flowChart').getContext('2d');
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');

            new Chart(flowCtx, {
                type: 'line',
                data: {
                    labels: ['6AM', '8AM', '10AM', '12PM', '2PM', '4PM', '6PM'],
                    datasets: [{
                        label: 'Traffic Volume',
                        data: [120, 450, 300, 400, 350, 600, 480],
                        borderColor: '#00d4ff',
                        backgroundColor: 'rgba(0, 212, 255, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#e5e7eb' } }
                    },
                    scales: {
                        x: { ticks: { color: '#9ca3af' }, grid: { color: '#374151' } },
                        y: { ticks: { color: '#9ca3af' }, grid: { color: '#374151' } }
                    }
                }
            });

            new Chart(performanceCtx, {
                type: 'radar',
                data: {
                    labels: ['Accuracy', 'Speed', 'Efficiency', 'Reliability', 'Coverage'],
                    datasets: [{
                        label: 'AI Performance',
                        data: [95, 88, 92, 96, 89],
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        pointBackgroundColor: '#8b5cf6'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { labels: { color: '#e5e7eb' } }
                    },
                    scales: {
                        r: {
                            ticks: { color: '#9ca3af' },
                            grid: { color: '#374151' },
                            pointLabels: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }

        // Control functions
        function uploadVideo() {
            alert('üìπ Video upload feature activated. Please select your traffic video file.');
            addEvent('üìπ New video feed uploaded and processed');
        }

        function toggleDetection() {
            aiDetectionEnabled = !aiDetectionEnabled;
            const btn = event.target;
            btn.textContent = aiDetectionEnabled ? 'ü§ñ AI Detection: ON' : 'ü§ñ AI Detection: OFF';
            btn.className = aiDetectionEnabled ? 'btn-primary px-4 py-2 rounded-lg text-sm font-medium' : 'btn-secondary px-4 py-2 rounded-lg text-sm font-medium';
            addEvent(`ü§ñ AI Detection ${aiDetectionEnabled ? 'enabled' : 'disabled'}`);
        }

        function optimizeTraffic() {
            alert('‚ö° Traffic optimization initiated! AI is analyzing patterns and adjusting signals.');
            addEvent('‚ö° Traffic optimization completed - 18% improvement achieved');
        }

        function emergencyMode() {
            alert('üö® Emergency mode activated! All signals prioritizing emergency vehicles.');
            addEvent('üö® Emergency mode activated - Priority routing enabled');
        }

        function resetSystem() {
            alert('üîÑ System reset initiated. All components returning to default state.');
            addEvent('üîÑ System reset completed - All modules reinitialized');
        }

        // Initialize system
        function initializeSystem() {
            initializeCanvases();
            generateTrafficGrid();
            initializeCharts();
            
            // Start periodic updates
            setInterval(updateMetrics, 3000);
            setInterval(addEvent, 10000);
            
            // Initial events
            setTimeout(() => addEvent("üöÄ TrafficFlow AI System initialized successfully"), 1000);
            setTimeout(() => addEvent("ü§ñ AI models loaded and ready for traffic analysis"), 3000);
            
            updateMetrics();
        }

        // Initialize when page loads
        window.addEventListener('load', initializeSystem);
        
        // Handle window resize
        window.addEventListener('resize', () => {
            setTimeout(initializeCanvases, 100);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97ee956ac1264e7b',t:'MTc1NzgzOTI3MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
